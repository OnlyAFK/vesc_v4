/**
 * @file    current_loop.c
 * @brief   电流环控制器 (兼容层)
 * @note    此文件保留用于向后兼容，新代码请使用 pid.c 和 foc_core.c
 */

#include "current_loop.h"

/*============================================================================*/
/*                    兼容旧代码的全局变量                                      */
/*============================================================================*/

PI_Controller_t pid_id = {0};
PI_Controller_t pid_iq = {0};

/*============================================================================*/
/*                    兼容旧代码的函数                                          */
/*============================================================================*/

/**
 * @brief  初始化电流环 PI 控制器
 */
void current_pi_init(void)
{
    PID_Init(&pid_id, 0.07037f, 0.01423f, 0.0f, 12.0f, -12.0f);
    PID_Init(&pid_iq, 0.07037f, 0.01423f, 0.0f, 12.0f, -12.0f);
}

/**
 * @brief  电流环计算
 */
void current_calc(PI_Controller_t *pPI)
{
    PI_Calc(pPI, pPI->Ref, pPI->Fdb);
}
